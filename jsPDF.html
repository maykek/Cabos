<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Tabela com Cabeçalho Vertical</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    #tabela {
      border-collapse: collapse;
      margin: 20px;
    }
    td, th {
      border: 1px solid black;
      padding: 10px;
      text-align: center;
    }
    /* Coluna vertical */
    th.vertical {
      height: 120px;
      vertical-align: bottom;
      padding: 0;
    }
    th.vertical > div {
      transform: rotate(90deg);
      transform-origin: left bottom;
      white-space: nowrap;
    }
  </style>
</head>
<body>
  <h2>Exemplo de Tabela</h2>

  <div id="minhaTabela">
    <table id="tabela">
      <tr>
        <th>Nome</th>
        <th>Idade</th>
        <th class="vertical"><div>Cidade</div></th>
      </tr>
      <tr>
        <td>Ana</td>
        <td>22</td>
        <td>Curitiba</td>
      </tr>
      <tr>
        <td>João</td>
        <td>30</td>
        <td>São Paulo</td>
      </tr>
      <tr>
        <td>Marcos</td>
        <td>27</td>
        <td>Belo Horizonte</td>
      </tr>
    </table>
  </div>

  <button onclick="gerarPDF()">Exportar PDF</button>

  <script>
    async function gerarPDF() {
      const { jsPDF } = window.jspdf;

      const div = document.querySelector("#minhaTabela");

      const canvas = await html2canvas(div, {
        scale: 2, // aumenta a resolução
        useCORS: true
      });

      const imgData = canvas.toDataURL("image/png");
      const pdf = new jsPDF("p", "mm", "a4");

      const pdfWidth = pdf.internal.pageSize.getWidth();
      const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

      pdf.addImage(imgData, "PNG", 0, 0, pdfWidth, pdfHeight);
      pdf.save("tabela.pdf");
    }
  </script>
</body>
</html>
